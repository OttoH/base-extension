(()=>{"use strict";class e{static getInstance(){return e.instance||(e.instance=new e),e.instance}constructor(){this.debounceTimer=null,this.setupMessageListener(),this.observePageChanges()}setupMessageListener(){chrome.runtime.onMessage.addListener((e,t,n)=>("extractContent"===e.action&&n(this.extractPageContent()),!0))}observePageChanges(){new MutationObserver(e=>{this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.notifyContentChange()},1e3)}).observe(document.body,{childList:!0,subtree:!0,attributes:!1})}notifyContentChange(){chrome.runtime.sendMessage({action:"contentChanged",url:window.location.href})}extractPageContent(){return{url:window.location.href,title:document.title,headings:this.extractHeadings(),petRelatedContent:this.extractPetContent(),metadata:this.extractMetadata(),extractedAt:(new Date).toISOString()}}extractHeadings(){const e=document.querySelectorAll("h1, h2, h3, h4, h5, h6");return Array.from(e).map(e=>({level:parseInt(e.tagName.substring(1)),text:e.textContent?.trim()||"",id:e.id||""}))}extractPetContent(){const e=["dog","cat","pet","animal","veterinary","vet","puppy","kitten","breed","health","nutrition","grooming","training","behavior","vaccine","vaccination","medical","clinic","hospital","care","wellness","surgery","treatment","medicine","diagnosis","therapy","emergency","dental","spay","neuter","parasite","flea","tick","heartworm","allergy","diet","exercise","adoption","rescue"],t=document.querySelectorAll(["p","div","span","article","section","li","td",'[class*="content"]','[class*="description"]','[class*="text"]','[class*="article"]','[class*="post"]','[class*="review"]'].join(", ")),n=[];return t.forEach((t,a)=>{const r=t.textContent?.toLowerCase()||"",s=t.textContent?.trim()||"";if(s.length<30||s.length>2e3)return;const i=e.filter(e=>r.includes(e.toLowerCase()));i.length>=1&&this.calculateRelevanceScore(r,e)>.1&&n.push({id:`pet-content-${a}`,text:s,keywords:i,tagName:t.tagName.toLowerCase(),className:t.className||"",type:this.determineContentType(t,i)})}),n.sort((e,t)=>t.keywords.length-e.keywords.length).slice(0,15)}calculateRelevanceScore(e,t){const n=e.split(/\s+/);return t.filter(t=>e.includes(t)).length/n.length}determineContentType(e,t){const n=e.className.toLowerCase(),a=e.tagName.toLowerCase(),r=["health","medical","veterinary","treatment","diagnosis","surgery"];return t.some(e=>r.includes(e))?"medical":n.includes("product")||n.includes("item")||"li"===a&&e.closest('[class*="product"]')?"product":n.includes("review")||n.includes("rating")||n.includes("comment")||n.includes("feedback")?"review":"article"===a||n.includes("article")||n.includes("post")||n.includes("blog")?"article":"pet-related"}extractMetadata(){const e={};return document.querySelectorAll("meta").forEach(t=>{const n=t.getAttribute("name")||t.getAttribute("property")||t.getAttribute("http-equiv")||"",a=t.getAttribute("content")||"";n&&a&&(e[n]=a)}),document.querySelectorAll('script[type="application/ld+json"]').forEach((t,n)=>{try{const a=JSON.parse(t.textContent||"");e[`structured_data_${n}`]=JSON.stringify(a)}catch(e){}}),e}}e.getInstance()})();
//# sourceMappingURL=content.js.map